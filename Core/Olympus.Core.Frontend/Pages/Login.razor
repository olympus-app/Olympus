@page "/login"
@layout Olympus.Core.Frontend.Layouts.LocksScreenLayout
@using Olympus.Core.Archend.Localization
@using Olympus.Core.Frontend.Pages

@attribute [AllowAnonymous]

<RadzenStack Gap="0" class="rz-border-radius-4 rz-shadow-10" Style="width: 100%; max-width: 400px; overflow: hidden;">

	<RadzenCard class="rz-shadow-0 rz-border-radius-0 rz-px-8 rz-py-4" style="text-align: center;">
		<RadzenImage Style="max-height: 8rem; max-width: 12rem;" Class="app-logo-portrait rz-m-4" />
		<RadzenText TextStyle="TextStyle.H5" Class="rz-m-1">@CoreStrings.Values.Login_Title</RadzenText>
		<RadzenText TextStyle="TextStyle.Body2" Class="rz-color-base-500">@CoreStrings.Values.Login_Subtitle</RadzenText>
	</RadzenCard>

	<RadzenCard class="rz-shadow-0 rz-border-radius-0 rz-pt-0 rz-pb-4" style="text-align: center;">
		<RadzenImage Path="/images/flags/pt.svg" title="Português" Click="@(() => LocalizationManager.SetCulture(AppCultureInfo.Portuguese))" Style="max-width: 1.2rem; border: var(--rz-border-normal); cursor: pointer;" Class="rz-border-radius-1 rz-m-1" />
		<RadzenImage Path="/images/flags/en.svg" title="English" Click="@(() => LocalizationManager.SetCulture(AppCultureInfo.English))" Style="max-width: 1.2rem; border: var(--rz-border-normal); cursor: pointer;" Class="rz-border-radius-1 rz-m-1" />
		<RadzenImage Path="/images/flags/es.svg" title="Español" Click="@(() => LocalizationManager.SetCulture(AppCultureInfo.Spanish))" Style="max-width: 1.2rem; border: var(--rz-border-normal); cursor: pointer;" Class="rz-border-radius-1 rz-m-1" />
	</RadzenCard>

	<RadzenCard class="rz-shadow-0 rz-border-radius-0 rz-px-8 rz-py-0">
		<RadzenStack Orientation="Orientation.Vertical" Gap="0" Class="rz-justify-content-center">

			<RadzenTemplateForm TItem="LoginRequest" Data="@Input" Submit="@OnLoginAsync">
				<RadzenStack Gap="0">

					<RadzenFormField Text="@CoreStrings.Values.Login_EmailLabel" Variant="Variant.Outlined" Style="width: 100%;">
						<RadzenTextBox @bind-Value="@Input.Email" Name="Email" />
					</RadzenFormField>
					<RadzenRequiredValidator Component="Email" Text="Email é obrigatório" />
					<RadzenEmailValidator Component="Email" Text="Formato de email inválido" />

					<RadzenFormField Text="@CoreStrings.Values.Login_PasswordLabel" Variant="Variant.Outlined" Style="width: 100%;">
						<RadzenPassword @bind-Value="@Input.Password" Name="Password" />
					</RadzenFormField>
					<RadzenRequiredValidator Component="Password" Text="Senha é obrigatória" />

					@if (!string.IsNullOrEmpty(ErrorMessage))
					{
						<RadzenAlert Severity="AlertSeverity.Error" Variant="Variant.Flat" Shade="Shade.Lighter" AllowClose="false" Size="AlertSize.Small">
							@ErrorMessage
						</RadzenAlert>
					}

					<RadzenButton ButtonType="ButtonType.Submit"
						Text="@CoreStrings.Values.Login_PasswordSignIn"
						ButtonStyle="ButtonStyle.Primary"
						Class="rz-w-100 rz-mt-2"
						BusyText="Aguarde..."
						IsBusy="@IsLoading" />
				</RadzenStack>
			</RadzenTemplateForm>

			<div class="rz-display-flex rz-align-items-center rz-justify-content-center rz-my-4">
				<div style="flex: 1; height: 1px; background-color: var(--rz-base-lighter);"></div>
				<RadzenText TextStyle="TextStyle.Caption" Class="rz-mx-3 rz-my-0 rz-color-base-500">@CoreStrings.Values.Login_OtherMethodsLabel.ToUpperInvariant()</RadzenText>
				<div style="flex: 1; height: 1px; background-color: var(--rz-base-lighter);"></div>
			</div>

			<RadzenStack Gap="0.5rem">

				<RadzenButton Click="@LoginWithPasskeyAsync"
					Text="@CoreStrings.Values.Login_PasskeySignIn"
					ButtonStyle="ButtonStyle.Secondary"
					Variant="Variant.Flat"
					Icon="fingerprint"
					Class="rz-w-100"
					BusyText="Aguarde..."
					IsBusy="@IsLoading" />

				<RadzenButton Click="@LoginWithMicrosoft"
					Text="@CoreStrings.Values.Login_MicrosoftSignIn"
					ButtonStyle="ButtonStyle.Light"
					Variant="Variant.Flat"
					Image="/images/identity/microsoft.svg"
					Class="rz-w-100"
					BusyText="Aguarde..."
					IsBusy="@IsLoading" />

			</RadzenStack>

		</RadzenStack>
	</RadzenCard>
	<RadzenCard class="rz-shadow-0 rz-border-radius-0 rz-px-8 rz-py-8" style="text-align: center;">
		<RadzenText TextStyle="TextStyle.Body2">
			@CoreStrings.Values.Login_AgreementLabel<br />
			<RadzenLink Path="/terms" Target="_blank">@CoreStrings.Values.Login_AgreementTerms</RadzenLink>
			@CoreStrings.Values.Login_AgreementJoin
			<RadzenLink Path="/privacy" Target="_blank">@CoreStrings.Values.Login_AgreementPolicy</RadzenLink>
		</RadzenText>
	</RadzenCard>
</RadzenStack>