@using Microsoft.AspNetCore.Components.Routing
@using Microsoft.AspNetCore.Components.Authorization
@using Olympus.Web.Pages

@namespace Olympus.Web.Routing

<CascadingAuthenticationState>
	<Router AppAssembly="@typeof(AppRouter).Assembly" AdditionalAssemblies="@HostInfo.ModulesAssemblies">
		<Found Context="routeData">
			@if (AllowAnonymous(routeData.PageType))
			{
				<RouteView RouteData="@routeData" DefaultLayout="@GetLayout(routeData.PageType)" />
			}
			else
			{
				<AuthorizeView>
					<Authorized>
						<RouteView RouteData="@routeData" DefaultLayout="@GetLayout(routeData.PageType)" />
					</Authorized>
					<NotAuthorized>
						@if (context.User.IsAuthenticated)
						{
							<LayoutView Layout="@typeof(MainLayout)">
								<AccessDeniedPage />
							</LayoutView>
						}
						else
						{
							<LayoutView Layout="@typeof(LocksScreenLayout)">
								<LoginRedirect />
							</LayoutView>
						}
					</NotAuthorized>
				</AuthorizeView>
			}
		</Found>
		<NotFound>
			<AuthorizeView>
				<Authorized>
					<LayoutView Layout="@typeof(MainLayout)">
						<NotFoundPage />
					</LayoutView>
				</Authorized>
				<NotAuthorized>
					<LayoutView Layout="@typeof(LocksScreenLayout)">
						<LoginRedirect />
					</LayoutView>
				</NotAuthorized>
			</AuthorizeView>
		</NotFound>
	</Router>
</CascadingAuthenticationState>